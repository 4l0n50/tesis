Ring signatures, introduced by Rivest, Shamir and Tauman, \cite{AC:RivShaTau01}, allow the holder of the secret key $sk$ for a signature scheme to \emph{anonymously} sign a message on behalf of a \emph{ring} of users $P_1,\ldots,P_n$, where $vk_i$ is the verification key of party $P_i$, only if $sk$ is the corresponding secret key of $vk_i$ for some $i\in[n]$. We define $R:=\{vk_1,\ldots,vk_n\}$ the set of public keys associated to the ring $P_1,\ldots,P_n$.

The literature on ring signatures is vast, and, while there exist even constant size solutions \cite{EC:DKNS04}, most of them rely on the \emph{Random Oracle Model} (ROM). The ROM idealises the behavior of hash functions and it has been showed to be flawed, in the sense that there are protocols secure in the ROM but insecure using any real hash functions \cite{STOC:CanGolHal98}. Without random oracles all the constructions have signatures of size linear in the size of the ring, being the the sole exception the $\Theta(\sqrt{n})$ Ring Signature of Chandran et al.~\cite{ICALP:ChaGroSah07} (already discussed, and optimized, in Section~\ref{sec:bits-applications}). We remark that no asymptotic improvements to Chandran et al.'s construction have been made since their introduction (only improvements in the constants by R\`afols \cite{TCC:Rafols15} and the improvements from Section~\ref{sec:bits-applications}). Moreover, in Section \ref{sec:rs-flawed} we show that two schemes which claim to obtain constant and logarithmic signature size, respectively, are flawed.


In this section we present the first Ring Signature whose signature size is asymptotically smaller than Chandran et al.'s. Specifically, our Ring Signature is of size $\Theta(\sqrt[3]{n})$. Interestingly, the security of our construction relies on a security assumption -- the \emph{Permutation Pairing assumption} -- introduced by Groth and Lu \cite{AC:GroLu07} in an unrelated setting: proofs of Correctness of a Shuffle. While the assumption is ``non-standard'', in the sense that is not a ``DDH like'' assumption, it is a falsifiable assumption and it was proven to be generically hard by Groth and Lu. For simplicity, we work on symmetric groups ($\GG_1=\GG_2$), but our techniques can be easily extended to asymmetric groups if a natural translation to asymmetric groups of the underlying assumption is given.

\subsection{High Level Description}

Our scheme follows the ring signature of Chandran et al.~Given a \emph{Boneh-Boyen signature scheme} (Section \ref{sec:bbs}), where the secret/verification keys are of the form $(sk,[vk])$ and $sk=vk\in\Z_q$, and given a \emph{One-time signature scheme} (Section \ref{sec:ots}), the signature of the message $m$ for a ring $R=\{[vk_1],\ldots,[vk_n]\}$ is computed as follows:
\begin{itemize}
\item[a)] pick a one-time signature key, sign $m$ with the one-time signature, and sign the one-time verification key with $sk$,
\item[b)] commit to the signature of the one-time verification key and to $[vk]$ and show that it is a valid signature key using GS proofs,
\item[c)] show that $[vk]\in R$.
\end{itemize}
The most costly part is c) and our contribution is a proof of size $\Theta(\sqrt[3]{n})$ of c).

Our construction is similar to the proof system for set membership with proof size $\Theta(\sqrt[3]{n})$ from Section~\ref{sec:bits-applications}. However, note that the proof system from Section~\ref{sec:bits-applications} does not suffice for constructing a ring signature because the CRS is fixed to a specific set and thus, the resulting ring signature will be fixed to a specific ring. 

In our scheme the secret/verification keys of party $P$ are $(sk,\vecb{vk})$, where $\vecb{vk}=([vk],[\vecb{a}],\vecb{a}[vk])$, $(sk,[vk])$ are secret/verification keys of the Boneh-Boyen signature scheme, and $\vecb{a}\in\Z_q^2$ is chosen independently for each key from some distribution $\mathcal{Q}$ to be specified later. Suppose that $[vk]=[vk_\alpha]$, where $\alpha=(i_\alpha,j_\alpha,k_\alpha):=(i_\alpha-1)m^2+(j_\alpha-1)m+k_\alpha$ and $m:=\sqrt[3]{n}$. Using the $\Theta(\sqrt{n})$ set membership proof from Section~\ref{sec:bits-applications} (the ``Set-Membership proof for Sets of Vectors'' where the CRS is independent of the set) and given the ring $R=\{\vecb{vk}_{(1,1,1)},\ldots,\vecb{vk}_{(m,m,m)}\}$, the prover selects the $(j_\alpha-1)m+k_\alpha$ th elements from the sets $S_1=\{\sum_{i\in[m]}[\vecb{a}_{(i,1,1)}],\ldots,\sum_{i\in[m]}[\vecb{a}_{(i,m,m)}]\}$ and $S_2=\{\sum_{i\in[m]}\vecb{a}_{(i,1,1)}[vk_{(i,1,1)}],\ldots,\sum_{i\in[m]}\vecb{a}_{(i,m,m)}[vk_{(i,m,m)}]\}$. We denote by $[\vecb{x}]$ and $[\vecb{y}]$ the elements from $S_1$ and $S_2$, respectively. Both sets are of size $n^{2/3}$ and thus the two set membership proofs are of size $\Theta(\sqrt[3]{n})$.
 
Note that the prover must also ensure that $[\vecb{x}]$ and $[\vecb{y}]$ are at the same position in their respective sets. Following the notation of the set-membership proof from Section \ref{sec:bits-applications}, this can be done using the same commitments to $b_1,\ldots,b_{\sqrt{n}}$ and $b'_1,\ldots,b'_{\sqrt{n}}$ in both proofs.

Now that the prover has selected elements $[\vecb{x}]=\sum_{i\in[m]}[\vecb{a}_{(i,j_\alpha,k_\alpha)}]$ and $[\vecb{y}]=\sum_{i\in[m]}\vecb{a}_{(i,j_\alpha,k_\alpha)}[vk_{(i,j_\alpha,k_\alpha)}]$, it additionally commits to $[\kappa_1]:=[vk_{(1,j_\alpha,k_\alpha)}],\ldots,\allowbreak[\kappa_m]:=[vk_{(m,j_\alpha,k_\alpha)}]$ and $[\vecb{z}_1]:=[\vecb{a}_{(1,j_\alpha,k_\alpha)}],\ldots,[\vecb{z}_m]:=[\vecb{a}_{(m,j_\alpha,k_\alpha)}]$. The verifier is now able to check that
\begin{equation}
\sum_{i\in[m]}[\vecb{z}_i][\kappa_i]=[\vecb{y}][1]. \label{eq:verif1}
\end{equation}

Provided that $\vecb{z}_1,\ldots,\vecb{z}_m$ is a permutation of $\vecb{a}_{(1,j_\alpha,k_\alpha)},\ldots,\vecb{a}_{(1,j_\alpha,k_\alpha)}$,
we can show that if $[\kappa_1],\ldots,[\kappa_m]$ is not a permutation of $[vk_{(1,j_\alpha,k_\alpha)}],\ldots,\allowbreak[vk_{(m,j_\alpha,k_\alpha)}]$, then we can extract an element from the kernel of the matrix $([\vecb{a}_{1,j_\alpha,k_\alpha}]\cdots\allowbreak [\vecb{a}_{m,j_\alpha,k_\alpha}])$. Thereby, provided that the corresponding kernel assumption is hard, the prover can simply select the $i_\alpha$ th element from $[\kappa_1],\ldots,\allowbreak [\kappa_m]$ which is guaranteed to be an element from the ring.

To show that $\vecb{z}_1,\ldots,\vecb{z}_m$ is a permutation of $\vecb{a}_{(1,j_\alpha,k_\alpha)},\ldots,\vecb{a}_{(1,j_\alpha,k_\alpha)}$ we will use the following assumption introduced by Groth and Lu \cite{AC:GroLu07}.
\begin{definition}[Permutation Pairing Assumption]
Let $\mathcal{Q}_{m}=\underbrace{\mathcal{Q}||\ldots||\mathcal{Q}}_{m\text{ times}}$, where concatenation of matrix distributions is defined in the natural way and 
$$\mathcal{Q}: \vecb{a}=\pmatri{x\\x^2},\quad x\gets\Z_q.$$
We say that the $m$-Permutation Pairing Assumption holds relative to $\G_s$ if for any adversary $\advA$
$$
\Pr\left[
\begin{array}{l}
gk\gets\G_s(1^k);\matr{A}\gets\mathcal{Q}_{m};[\matr{Z}]\gets\advA(gk,[\matr{A}]):\\
\mathrm{(i)} \sum_{i\in[m]}[\vecb{z}_i]=\sum_{i\in[m]}[\vecb{a}_i], \mathrm{(ii)}\ \forall i\in[m]\ [z_{2,i}][1]=[z_{1,i}][z_{1,i}],\\
\text{ and }\matr{Z}\text{ is not a permutation of the columns of }\matr{A}
\end{array}
\right],
$$
where $[\matr{Z}]=[(\vecb{z}_1,\ldots,\vecb{z}_m)],[\vecb{A}]=[(\vecb{a}_1,\ldots,\vecb{a}_m)]\in\GG^{2\times m}$,
is negligible in $k$.
\end{definition}

If the prover additionally proves that equations (i) and (ii) are satisfied for $\matr{A}:=(\vecb{a}_{(1,j_\alpha,k_\alpha)},\ldots,\vecb{a}_{(m,j_\alpha,k_\alpha)})$, which can be done with $\Theta(m)$ group elements using Groth-Sahai proofs, the assumption is guaranteeing that the columns of $\matr{Z}$ are a permutation of the columns of $\matr{A}$, for some permutation $\pi\in S_m$. Therefore, equation (\ref{eq:verif1}) implies that
\begin{align*}
\sum_{i\in[m]}[\vecb{z}_i][\kappa_i]&=\sum_{i\in[m]}[\vecb{a}_{(\pi(i),j_\alpha,k_\alpha)}][\kappa_i]=\sum_{i\in[m]}[\vecb{a}_{(i,j_\alpha,k_\alpha)}][\kappa_{\pi^{-1}(i)}]\\
&=\sum_{i\in[m]}[\vecb{a}_{(i,j_\alpha,k_\alpha)}][vk_{(i,j_\alpha,k_\alpha)}].
\end{align*}
Then $\kappa_1,\ldots,\kappa_m$ is a permutation of $\vecb{a}_{(1,j_\alpha,k_\alpha)},\ldots,\vecb{a}_{(m,j_\alpha,k_\alpha)}$ (the same defined by $\vecb{z}_1,\ldots,\vecb{z}_m$), unless $(\kappa_{\pi^{-1}(1)}-{vk_{(1,j_\alpha,k_\alpha)}),\ldots,\kappa_{\pi^{-1}(m)}-vk_{(m,j_\alpha,k_\alpha)})})^\top$ is in the kernel of $\matr{A}$. Groth and Lu showed the hardness of finding an element from $\ker(\matr{A})$, when $\matr{A}$ is sampled from $\mathcal{Q}_m$, in the generic group model. They called this assumption the \emph{Simultaneous Pairing Assumption} and it corresponds to the $\mathcal{Q}_m^\top\mbox{-}\kermdh$ assumption.


\paragraph{Remark.}
A natural question is if this technique can be applied once again. That is, to compute a $\Theta(\sqrt[4]{n})$  proof, compute commitments to an element from $S_1=\{\sum_{i\in[m]}\vecb{a}_{(i,1,1,1)}[vk_{(i,1,1,1)}],\ldots,\sum_{i\in[m]}\vecb{a}_{(i,m,m,m)}[vk_{(i,m,m,m)}]\}$ and $S_2=\allowbreak\{\sum_{i\in[m]}[\vecb{a}_{(i,1,1,1)}],\ldots,\sum_{i\in[m]}[\vecb{a}_{(i,m,m,m)}]\}$, and then prove that they belong to the respective sets with the proof of size $\Theta(\sqrt[3]{n})$. Since $|S_1|=|S_2|=n^{3/4}$, proof will be of size $\Theta(\sqrt[3]{n^{3/4}})=\Theta(\sqrt[4]{n})$. However, this is not possible since the $\Theta(\sqrt[3]{n})$ proof is not a set membership proof for arbitrary sets, but only for sets where each element is of the form $([vk],\vecb{a}[vk],[\vecb{a}])$.

\subsection{Groth-Sahai Proofs in the $\lin{2}$ Instantiation}
In our ring signature we use as primitive Groth-Sahai proofs, which we have only instantiated in the SXDH setting. Since the SXDH (and DDH) is false in symmetric groups, in order to use Groth-Sahai proofs in symmetric groups one usually instantiates them using the $\lin{2}$ assumption. Following \cite{EC:GroSah08}, in symmetric groups and using the $\lin{2}$ assumption, GS commitments are vectors in $\GG^3$ of the form
$$
\GS.\Com_{ck}([x];\vecb{r})=\pmatri{{[0]}\\{[0]}\\{[x]}}+r_1[\vecb{u}_1]+{r}_2[\vecb{u}_2]+r_3[\vecb{u}_3]
$$
where $ck:=([\vecb{u}_1]||[\vecb{u}_2][\vecb{u}_3])$, $(\vecb{u}_2||\vecb{u}_3)\gets\distlin_2$ and $\vecb{u}_1:=w_1\vecb{u}_2+w_2\vecb{u}_3$ in the perfectly binding setting, and $\vecb{u}_1:=w_1\vecb{u}_2+w_2\vecb{u}_3-\vecb{e}_3$ in the perfectly hiding setting, for $w_1,w_2\gets\Z_q$. Security of GS commitments follows from the hardness of the $\lin{2}$ assumption in symmetric groups.

As consequence of the enlargement of commitments, proofs are also larger (for example, 9 group elements for pairing product equations). The form of the proofs is similar  to the asymmetric case (see Section \ref{sec:gs-proofs-scheme}), but we do not give the full detail since it does not help for understanding our ring signature nor for proving its security. 


\subsection{Flawed Constructions}\label{sec:rs-flawed}
In \cite{ACISP:BosDasRan15}, Bose et al.~claim to construct a constant-size ring signature in the standard model. However, they construct a weak Ring Signature where: a) the public keys are generated all at once in a correlated way; b) the set of parties which are able to participate in a ring is fixed as well as the maximum ring size; and c) the key size is linear in the maximum ring size. In the work of Chandran et al.~and also in our setting: a) the key generation is independently run by the user using only the CRS as input; b) any party can be member of the ring as long as she has a verification key, and the maximum ring size is unbounded; and c) the key size is constant. These stronger requirements are in line with the original spirit of \emph{non-coordination} of  Rivest et al.~\cite{AC:RivShaTau01}.

In \cite{IET:GriSusPla16}, Gritti et al.~claim to construct a logarithmic ring signature in the standard model. However, their construction is completely flawed as explained below. 
In page 12 of \cite{IET:GriSusPla16}, Gritti et al.~define $v_{b_i} := v_{b_1\cdots b_i *}$, where $b_1\cdots b_i *$ is the set of all bit-strings of size $d:=\log n$ whose prefix is $b_1\cdots b_i$. From this, one have to conclude that $v_{b_i}$ is a set (or vector) of group elements of size $2^{d-i}$.
In the same page they define the commitment $D_{b_i} := v_{b_i}h^{s_{b_i}}$, for random $s_{b_i}\in\Z_q$, which, according to the previous observation, is the multiplication of a set (or vector) of group elements with a group element. Given that length reducing group to group commitments are known to not exist \cite{EC:AbeHarOhk12}, its representation require at least $2^{d-i}$ group elements . Since commitments $D_{b_0},\ldots,D_{b_d}$ are part of the signature, the actual signature size is $\Theta(2^d)=\Theta(n)$, rather than  $\Theta(d)=\Theta(\log n)$ as claimed by Gritti et al.\footnote{We used multiplicative notation for the group operations to keep the expressions as they appear in \cite{IET:GriSusPla16}.}

\subsection{Definition}
We follow the definitions from \cite{ICALP:ChaGroSah07} described below.

\begin{definition}[Ring Signature]
A ring signature scheme consists of a quadruple of
PPT algorithms $(\mathsf{CRSGen}, \KG, \mathsf{Sign}, \mathsf{Verify})$ that respectively, generate the common
reference string, generate keys for a user, sign a message, and verify the signature of a
message. More formally:
\begin{itemize}
\item $\mathsf{CRSGen}(gk)$, where $gk$ is the group key, outputs the common reference
string $\rho$.
\item $\KG(\rho)$ is run by the user. It outputs a public verification key $vk$ and a private
signing key $sk$.
\item $\mathsf{Sign}_{\rho,sk}(m, R)$ outputs a signature $\sigma$ on the message $m$ with respect to the ring
$R = \{vk_1,\ldots,vk_n\}$. We require that $(vk, sk)$ is a valid key-pair output by $\KG$
and that $vk \in R$.
\item $\mathsf{Verify}_{\rho,R}(m, \sigma)$ verifies a purported signature $\sigma$ on a message $m$ with respect to
the ring of public keys $R$.
\end{itemize}
The quadruple $(\mathsf{CRSGen}, \KG, \mathsf{Sign}, \mathsf{Verify})$ is a ring signature with perfect
anonymity if it has perfect correctness, computational unforgeability and perfect
anonymity as defined below.
\end{definition}

\begin{definition}[Perfect Correctness]
We require that a user can sign any message on behalf of a ring where she is a member. A ring signature $(\mathsf{CRSGen},\allowbreak \KG, \mathsf{Sign}, \mathsf{Verify})$
has perfect correctness if for all adversaries $\advA$ we have:
$$
\Pr\left[\begin{array}{l}
gk\gets\G(1^\lambda);\rho\gets\mathsf{CRSGen}(gk);(vk,sk)\gets\KG(\rho);\\
(m,R)\gets\advA(\rho,vk,sk);\sigma\gets\mathsf{Sign}_{\rho,sk}(m;R):\\
\mathsf{Verify}_{\rho,R}(m,\sigma)\text{ or }vk\notin R
\end{array}\right]=1
$$
\end{definition}

\begin{definition}[Computational Unforgeability]
A ring signature scheme $(\mathsf{CRSGen}, \KG, \mathsf{Sign}, \mathsf{Verify})$
is unforgeable if it is infeasible to forge a ring
signature on a message without controlling one of the members in the ring. Formally, it
is unforgeable when for any non-uniform polynomial
time adversaries $\advA$ we have that
$$
\Pr\left[\begin{array}{l}
gk\gets\G(1^\lambda);\rho\gets\mathsf{CRSGen}(gk);(m,R,\sigma)\gets\advA^{\mathsf{VKGen},\mathsf{Sign},\mathsf{Corrupt}}(\rho):\\
\mathsf{Verify}_{\rho,R}(m,\sigma)=1
\end{array}\right]
$$
is negligible in th security parameter, where

\begin{itemize}
\item $\mathsf{VKGen}$ on query number $i$ selects randomness $w_i$, computes $(vk_i,sk_i):= \KG(\rho; w_i)$
and returns $vk_i$.
\item $\mathsf{Sign}(\alpha, m, R)$ returns $\sigma \gets \mathsf{Sign}_{\rho,sk_\alpha}(m, R)$, provided $(vk_\alpha, sk_\alpha)$ has been generated
by $\mathsf{VKGen}$ and $vk_\alpha\in R$.
\item $\mathsf{Corrupt}(i)$ returns $w_i$ (from which $sk_i$ can be computed) provided $(vk_i, sk_i)$ has
been generated by $\mathsf{VKGen}$.
\item $\advA$ outputs $(m, R, \sigma)$ such that $\mathsf{Sign}$ has not been queried with $(*, m, R)$ and $R$
only contains keys $vk_i$ generated by $\mathsf{VKGen}$ where $i$ has not been corrupted.
\end{itemize}
\end{definition}

\begin{definition}[Perfect Anonymity]
A ring signature scheme
$(\mathsf{CRSGen},\allowbreak \KG,\allowbreak \mathsf{Sign}, \mathsf{Verify})$ has perfect anonymity, if a signature on a message
$m$ under a ring $R$ and key $vk_{i_0}$
looks exactly the same as a signature on the
message $m$ under the ring $R$ and key $vk_{i_1}$, where $vk_{i_0},vk_{i_1}\in R$. This means that the signer's key is hidden
among all the honestly generated keys in the ring. Formally, we require that for any unbounded
adversary $\advA$:
\begin{align*}
&\Pr\left[\begin{array}{l}
gk\gets\G_a(1^\lambda);\rho\gets\mathsf{CRSGen}(gk);\\
(m,i_0,i_1,R)\gets\advA^{\KG(\rho)}(\rho);\sigma\gets\mathsf{Sign}_{\rho,sk_{i_0}}(m,R):\\
\advA(\sigma)=1
\end{array}\right]
=\\
&\Pr\left[\begin{array}{l}
gk\gets\G_a(1^\lambda);\rho\gets\mathsf{CRSGen}(gk);\\
(m,i_0,i_1,R)\gets\advA^{\KG(\rho)}(\rho);\sigma\gets\mathsf{Sign}_{\rho,sk_{i_1}}(m,R):\\
\advA(\sigma)=1
\end{array}\right]
\end{align*}
where $\advA$ chooses $i_0, i_1$ such that $(vk_{i_0}, sk_{i_0}),(vk_{i_1}, sk_{i_1})$ have been generated by the
oracle $\KG(\rho)$.
\end{definition}

\subsection{Boneh-Boyen Signatures} \label{sec:bbs}

Boneh and Boyen described a short signature -- each signature consists of only one group element -- which is UF-CMA without random oracles \cite{EC:BonBoy04a}. Interestingly, the verification of the validity of any signature-message pair can be written as a set of pairing product equations. Thereby, using Groth-Sahai proofs one can show the possession of a valid signature without revealing the actual signature (as done in Chandran et al.'s ring signature and our ring signature).

The Boneh-Boyen signature is proven UF-CMA secure under the $m$-\emph{Strong Diffie-Hellman} assumption, which is described below.

\begin{definition}[$m\mbox{-}SDH$ assumption]
For any adversary $\advA$
$$
\Pr\left[gk\gets\G_s(1^\lambda),x\gets\Z_q:\advA(gk,[x],[x^2],\ldots,[x^m])=(c,\left[\frac{1}{x+c}\right])\right]
$$
is negligible in $\lambda$.
\end{definition}

The Boneh-Boyen signature scheme is described below.

\begin{description}
\item[$\mathsf{BB}.\KG$:] Given a group key $gk$, pick $vk\gets\Z_q$. The secret/public key pair is defined as $(sk,[vk]):=(vk,[vk])$.
\item[$\mathsf{BB}.\Sign$:] Given a secret key $sk\in\Z_q$ and a message $m\in\Z_q$, output the signature $[\sigma]:=\left[\frac{1}{sk+m}\right]$. In the unlikely case that $sk+m=0$ we let $[\sigma]:=[0]$.
\item[$\mathsf{BB}.\Ver$:] On input the verification key $[vk]$, a message $m\in\Z_q$, and a signature $[\sigma]$, verify that $[m+vk][\sigma]=[1]_T$.
\end{description} 

\subsection{Our Construction}

\begin{description}
\item[$\mathsf{CRSGen}(gk)$:] Pick a perfectly hiding CRS for the Groth-Sahai proof system $\crs_\GS$, and a CRS for the proof of the $\Theta(\sqrt{n})$ proof of membership in a set $\crs_\sfset$ (Section \ref{sec:bits-applications}), and output $\rho:=(gk,\crs_\GS,\crs_\sfset).$
\item[$\KG(\rho)$:] Pick $\vecb{a}\gets\mathcal{Q}$ and $(sk,[vk])\gets\mathsf{BB}.\KG(gk)$. The secret key is $sk$ and the verification key is $\vecb{vk}:=([vk],[\vecb{a}],\vecb{a}[vk])$.
\item[$\mathsf{Sign}_{\rho,sk}(m,R)$:]
\begin{enumerate}
\item Compute $(sk_\mathsf{ot},vk_\mathsf{ot})\gets\mathsf{OT}.\KG(gk)$ and $\sigma_\mathsf{ot}\gets\mathsf{OT}.\mathsf{Sign}_{sk_\mathsf{ot}}(m,R)$.
\item Compute $[\vecb{c}]:=\GS.\Com_{ck}([vk];r)$, $r\gets\Z_q$, $[\sigma]\gets\mathsf{BB}.\mathsf{Sign}_{sk}(vk_\mathsf{ot})$, $[\vecb{d}]:=\GS.\Com_{ck}([\sigma];s)$, and a GS proof $\pi_\GS$ that $\mathsf{BB}.\mathsf{Ver}_{[vk]}([\sigma],[vk_\mathsf{ot}])=1$ (which can be expressed as a set of pairing product equations).
\item Parse $R$ as $\{\vecb{vk}_{(1,1,1)},\ldots,\vecb{vk}_{(m,m,m)}\}$, where $m:=\sqrt[3]{|R|}$, and let $\alpha=(i_\alpha,j_\alpha,k_\alpha)$ the index of $\vecb{vk}$ in $R$. Define the sets $S_1=\{\sum_{i\in[m]}[\vecb{a}_{(i,1,1)}],\allowbreak\ldots,\sum_{i\in[m]}[\vecb{a}_{(i,m,m)}]\}$ and $S_2=\{\sum_{i\in[m]}\vecb{a}_{(i,1,1)}[vk_{(i,1,1)}],\allowbreak\ldots,\sum_{i\in[m]}\vecb{a}_{(i,m,m)}[vk_{(i,m,m)}]\}$.
\item Compute GS commitments to $[\vecb{x}]:=\sum_{i\in[m]}[\vecb{a}_{(i,j_\alpha,k_\alpha)}]$ and $[\vecb{y}]=\sum_{i\in[m]}\vecb{a}_{(i,j_\alpha,k_\alpha)}[vk_{(i,j_\alpha,k_\alpha)}]$, and compute proofs $\pi_1$ and $\pi_2$ that they belong to $S_1$ and $S_2$, respectively (recall that it is also proven that they appear in the same positions reutilising the commitments to $b_1,\ldots,b_{\sqrt{n}}$ and $b'_1,\ldots,b'_{\sqrt{n}}$).
\item Compute GS commitments to $[\kappa_1]:=[vk_{(1,j_\alpha,k_\alpha)}],\ldots,[\kappa_m]:=[vk_{(m,j_\alpha,k_\alpha)}]$ and $[\vecb{z}_1]:=[\vecb{a}_{(1,j_\alpha,k_\alpha)}],\ldots,[\vecb{z}_m]:=[\vecb{a}_{(m,j_\alpha,k_\alpha)}]$, and GS proof $\pi_\kappa$ that $\sum_{i\in[m]}[\kappa_i][\vecb{z}_i]=[\vecb{y}][1]$ and a GS proof $\pi_{z}$ that $\sum_{i\in[m]}[\vecb{z}_i]=[\vecb{x}]$ and $[z_{2,i}][1]=[z_{1,i}][z_{1,i}]$ for each $i\in[m]$.
\item Compute a proof $\pi_3$ that $[vk]$ belongs to $S_3=\{[\kappa_1],\ldots,[\kappa_m]\}$.
\item Return the signature $\grkb{\sigma}:=(vk_\mathsf{ot},\sigma_\mathsf{ot},[\vecb{c}],[\vecb{d}],\pi_1,\pi_2,\pi_3,\pi_\kappa,\pi_z)$. (GS proofs include commitments to variables).
\end{enumerate}
\item[$\mathsf{Verify}_{\rho,R}(m,\grkb{\sigma})$:] Verify the validity of the one-time signature and of all the proofs. Return 0 if any of these checks fails and 1 otherwise.
\end{description}

\begin{theorem}
The scheme presented in this section is a ring signature scheme
with perfect correctness, perfect anonymity and computational unforgeability under the
$m$-permutation pairing assumption, the $\mathcal{Q}_m^\top\mbox{-}\kermdh$ assumption, the $\lin{2}$ assumption, and the assumption
that the one-time signature and the Boneh-Boyen signature are unforgeable.
\end{theorem}
\begin{proof}
Perfect correctness follows directly from the definitions. Perfect anonymity follows from the fact that the perfectly hiding Groth-Sahai CRS defines perfectly hiding and perfect zero-knowledge proofs, information theoretically hiding any information about $\vecb{vk}$.

Computational unforgeability is proven as follows. The $\lin{2}$ assumption implies that $\crs_\GS$ can be changed to a perfectly binding CRS, at the cost of a negligible security loss. For the sake of contradiction, suppose that $\vecb{vk}\notin R$. Soundness of Groth-Sahai proofs and of the $\Theta(\sqrt{n})$ proof of set membership, implies that there exist $j_\alpha,k_\alpha\in[m]$ such that
\begin{align}
&\sum_{i\in[m]}[\kappa_i][\vecb{z}_i]=\sum_{i\in[m]}\vecb{a}_{(i,j_\alpha,k_\alpha)}[vk_{(i,j_\alpha,k_\alpha)}]\text{ and }\label{eq-rs-1}\\
&\sum_{i\in[m]}[\vecb{z}_i]=\sum_{i\in[m]}[\vecb{a}_{(i,j_\alpha,k_\alpha)}], \label{eq-rs-2}\\
&[z_{i,2}][1]=[z_{i,1}][z_{i,1}] \text{ for all }i\in[m],\label{eq-rs-3}
\end{align}
and that $[vk]=[\kappa_{i^*}]$, for some $i^*\in[m]$. Equations (\ref{eq-rs-2}) and (\ref{eq-rs-3}) imply that $(\vecb{z}_1,\ldots,\vecb{z}_m)$ is a permutation of $(\vecb{a}_{(1,j_\alpha,k_\alpha)}\ldots,\vecb{a}_{(m,j_\alpha,k_\alpha)})$ unless one can break the $m$-permutation pairing assumption. Therefore, equation (\ref{eq-rs-1}) implies that there is a permutation $\pi$ such that
\begin{align}
\sum_{i\in[m]}(\kappa_i-vk_{(\pi(i),j_\alpha,k_\alpha)})\vecb{a}_i=0.
\end{align}
Assuming $[\kappa_{i^*}]\notin R$, $([\kappa_1]-[vk_{(\pi(1),j_\alpha,k_\alpha)}],\ldots,[\kappa_m]-[vk_{(\pi(m),j_\alpha,k_\alpha)}])\neq [\vecb{0}]$ is a solution to the $\mathcal{Q}_m^\top\mbox{-}\kermdh$ problem. We conclude that $\vecb{vk}\in R$.

Finally, since $[\vecb{c}]$ is a commitment to a valid signature of $vk_\mathsf{ot}$ under $[vk]$ and given that $vk_\mathsf{ot}$ has not been previously used, $[\sigma]$ is a forgery of the Boneh-Boyen signature scheme. By the unforgeability of the Boneh-Boyen signature scheme, this happens only with negligible probability.
\end{proof}
